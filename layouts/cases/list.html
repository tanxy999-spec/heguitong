{{ define "main" }}
<!-- 核心内容区 -->
<main class="container mx-auto px-4 py-6">
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <!-- 左侧主栏 (60%) -->
        <div class="lg:col-span-2 space-y-6">
            <!-- Banner -->
            <div class="relative bg-primary rounded-md overflow-hidden">
                <div class="absolute inset-0 flex items-center justify-center">
                    <img src="https://picsum.photos/seed/cases/1200/300" alt="背景" class="w-full h-64 object-cover opacity-20">
                </div>
                <div class="relative z-10 p-8 text-white">
                    <h2 class="text-2xl md:text-3xl font-bold mb-4">典型案例库</h2>
                    <p class="text-white text-opacity-90">通过真实案例学习，助力公益组织合规发展</p>
                </div>
            </div>

            <!-- 全部案例列表 -->
            <section id="all-cases" class="space-y-6">
                <div class="bg-white border border-darkGray rounded-md p-6 space-y-6">
                            <!-- 按时间倒序排列的所有案例 -->
                            {{ $allCases := where .Site.RegularPages "Section" "cases" }}
                            {{ $sortedCases := sort $allCases "Date" "desc" }}
                            {{ $paginator := .Paginate $sortedCases 5 }} <!-- 改为每页显示5个 -->
                            {{ range $paginator.Pages }}
                            <div class="case-card bg-white border border-darkGray rounded-md overflow-hidden">
                            <div class="md:flex">
                                <div class="md:w-1/3">
                                    <img src="https://picsum.photos/seed/{{ .Params.slug | default .Title }}/600/400" alt="{{ .Title }}" class="w-full h-full object-cover h-48 md:h-full">
                                </div>
                                <div class="p-6 md:w-2/3">
                                    {{ with .Params.categories }}
                                        {{ range first 1 . }}
                                            {{ if eq . "行政处罚案例" }}
                                                <span class="inline-block bg-red-100 text-red-700 text-xs px-2 py-1 rounded mb-2">行政处罚</span>
                                            {{ else if eq . "合规成功案例" }}
                                                <span class="inline-block bg-green-100 text-green-700 text-xs px-2 py-1 rounded mb-2">合规成功</span>
                                            {{ else if eq . "行业典型案例" }}
                                                <span class="inline-block bg-blue-100 text-blue-700 text-xs px-2 py-1 rounded mb-2">行业典型</span>
                                            {{ end }}
                                        {{ end }}
                                    {{ end }}
                                    <h4 class="text-lg font-bold text-neutral mb-2">{{ .Title }}</h4>
                                    <p class="text-gray-600 mb-4 line-clamp-3">{{ .Description | default (plainify (substr .Content 0 150)) }}{{ if not .Description }}...{{ end }}</p>
                                    <div class="flex justify-between items-center">
                                        <span class="text-gray-500 text-sm"><i class="fa fa-calendar mr-1"></i> {{ .Date.Format "2006-01-02" }}</span>
                                        {{ $url := .RelPermalink }}
                                    {{ if .Params.slug }}
                                        {{ $url = printf "/cases/%s/" .Params.slug }}
                                    {{ end }}
                                    <a href="{{ $url }}" class="text-primary hover:text-red-700 font-medium flex items-center">
                                        查看详情 <i class="fa fa-angle-right ml-2"></i>
                                    </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {{ end }}

                    <!-- 简化的分页 -->
                    <div class="mt-8 flex justify-center">
                        <nav class="inline-flex rounded-md shadow">
                            {{ if $paginator.HasPrev }}
                            <a href="{{ $paginator.Prev.URL }}" class="px-3 py-2 border border-gray-300 text-sm font-medium rounded-l-md text-gray-500 bg-white hover:bg-gray-50">
                                <span class="sr-only">上一页</span>
                                <i class="fa fa-angle-left"></i>
                            </a>
                            {{ else }}
                            <a href="#" class="px-3 py-2 border border-gray-300 text-sm font-medium rounded-l-md text-gray-400 bg-gray-100 cursor-not-allowed">
                                <span class="sr-only">上一页</span>
                                <i class="fa fa-angle-left"></i>
                            </a>
                            {{ end }}
                            
                            {{ range $paginator.Pagers }}
                            <a href="{{ .URL }}" class="px-3 py-2 border-t border-b border-gray-300 text-sm font-medium {{ if eq . $paginator }}bg-primary text-white{{ else }}text-gray-700 bg-white hover:bg-gray-50{{ end }}">
                                {{ .PageNumber }}
                            </a>
                            {{ end }}
                            
                            {{ if $paginator.HasNext }}
                            <a href="{{ $paginator.Next.URL }}" class="px-3 py-2 border border-gray-300 text-sm font-medium rounded-r-md text-gray-500 bg-white hover:bg-gray-50">
                                <span class="sr-only">下一页</span>
                                <i class="fa fa-angle-right"></i>
                            </a>
                            {{ else }}
                            <a href="#" class="px-3 py-2 border border-gray-300 text-sm font-medium rounded-r-md text-gray-400 bg-gray-100 cursor-not-allowed">
                                <span class="sr-only">下一页</span>
                                <i class="fa fa-angle-right"></i>
                            </a>
                            {{ end }}
                        </nav>
                    </div>
                </div>
            </section>
        </div>

        <!-- 右侧边栏 (40%) -->
        <div class="lg:col-span-1 space-y-6">
            <!-- 案例分类 -->
            <div class="bg-white border border-darkGray rounded-md p-6">
                <h3 class="text-lg font-bold text-primary mb-4">案例分类</h3>
                <ul class="space-y-2">
                    <li>
                        <a href="" class="flex items-center justify-between py-2 px-4 rounded-md bg-primary/10 text-primary">
                            <span class="flex items-center"><i class="fa fa-th-list mr-3"></i>全部案例</span>
                            <span class="text-sm bg-primary text-white px-2 py-0.5 rounded-full">{{ len $allCases }}</span>
                        </a>
                    </li>
                    {{ $punishmentCases := where $allCases "Params.categories" "intersect" (slice "行政处罚案例") }}
                    {{ $successCases := where $allCases "Params.categories" "intersect" (slice "合规成功案例") }}
                    {{ $typicalCases := where $allCases "Params.categories" "intersect" (slice "行业典型案例") }}
                    <li>
                        <a href="" class="flex items-center justify-between py-2 px-4 rounded-md hover:bg-gray-100">
                            <span class="flex items-center"><i class="fa fa-exclamation-triangle mr-3"></i>行政处罚案例</span>
                            <span class="text-sm bg-gray-200 text-gray-700 px-2 py-0.5 rounded-full">{{ len $punishmentCases }}</span>
                        </a>
                    </li>
                    <li>
                        <a href="" class="flex items-center justify-between py-2 px-4 rounded-md hover:bg-gray-100">
                            <span class="flex items-center"><i class="fa fa-check-circle mr-3"></i>合规成功案例</span>
                            <span class="text-sm bg-gray-200 text-gray-700 px-2 py-0.5 rounded-full">{{ len $successCases }}</span>
                        </a>
                    </li>
                    <li>
                        <a href="" class="flex items-center justify-between py-2 px-4 rounded-md hover:bg-gray-100">
                            <span class="flex items-center"><i class="fa fa-star mr-3"></i>行业典型案例</span>
                            <span class="text-sm bg-gray-200 text-gray-700 px-2 py-0.5 rounded-full">{{ len $typicalCases }}</span>
                        </a>
                    </li>
                </ul>
            </div>

            <!-- 典型案例 -->
            <div class="bg-white border border-darkGray rounded-md p-6">
                <h3 class="text-lg font-bold text-primary mb-4">典型案例</h3>
                <div class="space-y-4">
                    <div class="flex items-start space-x-3">
                        <div class="flex-shrink-0 w-16 h-16 bg-gray-200 rounded overflow-hidden">
                            <img src="https://picsum.photos/seed/annual-report-compliance/200/200" alt="慈善组织年度报告合规案例分析" class="w-full h-full object-cover">
                        </div>
                        <div class="flex-1 min-w-0">
                            <a href="/cases/annual-report-compliance/" class="text-sm font-medium text-neutral hover:text-primary line-clamp-2">慈善组织年度报告合规案例分析</a>
                            <p class="text-xs text-gray-500 mt-1"><i class="fa fa-calendar mr-1"></i> 2023-12-20</p>
                        </div>
                    </div>
                    <div class="flex items-start space-x-3">
                        <div class="flex-shrink-0 w-16 h-16 bg-gray-200 rounded overflow-hidden">
                            <img src="https://picsum.photos/seed/charity-program-management/200/200" alt="某慈善基金会项目管理合规案例分析" class="w-full h-full object-cover">
                        </div>
                        <div class="flex-1 min-w-0">
                            <a href="/cases/charity-program-management/" class="text-sm font-medium text-neutral hover:text-primary line-clamp-2">某慈善基金会项目管理合规案例分析</a>
                            <p class="text-xs text-gray-500 mt-1"><i class="fa fa-calendar mr-1"></i> 2024-03-15</p>
                        </div>
                    </div>
                    <div class="flex items-start space-x-3">
                        <div class="flex-shrink-0 w-16 h-16 bg-gray-200 rounded overflow-hidden">
                            <img src="https://picsum.photos/seed/education-foundation-innovation/200/200" alt="教育类基金会创新资助模式实践与启示" class="w-full h-full object-cover">
                        </div>
                        <div class="flex-1 min-w-0">
                            <a href="/cases/education-foundation-innovation/" class="text-sm font-medium text-neutral hover:text-primary line-clamp-2">教育类基金会创新资助模式实践与启示</a>
                            <p class="text-xs text-gray-500 mt-1"><i class="fa fa-calendar mr-1"></i> 2023-06-10</p>
                        </div>
                    </div>
                    <div class="flex items-start space-x-3">
                        <div class="flex-shrink-0 w-16 h-16 bg-gray-200 rounded overflow-hidden">
                            <img src="https://picsum.photos/seed/environmental-ngo-governance/200/200" alt="某环保NGO参与环境治理典型案例" class="w-full h-full object-cover">
                        </div>
                        <div class="flex-1 min-w-0">
                            <a href="/cases/environmental-ngo-governance/" class="text-sm font-medium text-neutral hover:text-primary line-clamp-2">某环保NGO参与环境治理典型案例</a>
                            <p class="text-xs text-gray-500 mt-1"><i class="fa fa-calendar mr-1"></i> 2023-07-05</p>
                        </div>
                    </div>
                    <div class="flex items-start space-x-3">
                        <div class="flex-shrink-0 w-16 h-16 bg-gray-200 rounded overflow-hidden">
                            <img src="https://picsum.photos/seed/detail-punishment-6/200/200" alt="基金会违规募捐及财务披露不规范案例分析" class="w-full h-full object-cover">
                        </div>
                        <div class="flex-1 min-w-0">
                            <a href="/cases/detail-punishment-6/" class="text-sm font-medium text-neutral hover:text-primary line-clamp-2">基金会违规募捐及财务披露不规范案例分析</a>
                            <p class="text-xs text-gray-500 mt-1"><i class="fa fa-calendar mr-1"></i> 2024-05-15</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>
{{ end }}